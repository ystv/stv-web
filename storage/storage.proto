syntax = "proto3";
package storage;
option go_package = "github.com/ystv/stv-web/storage";

message STV {
    repeated Ballot ballots = 1;
    repeated Candidate candidates = 2;
    repeated Election elections = 3;
    repeated URL urls = 4;
    repeated Voter voters = 5;
    bool allowRegistration = 6;
}

message Ballot {
    uint64 id = 1;
    uint64 election = 2;
    string voter = 3;
    map<uint64, string> choice = 4; // map[order, candidate id]
}

message Candidate {
    string id = 1;
    uint64 election = 2;
    string name = 3;
}

message Election {
    uint64 id = 1;
    string name = 2;
    string description = 3;
    bool ron = 4;
    bool open = 5;
    bool closed = 6;
    Result result = 7;
    repeated Voter excluded = 8;
}

message Result {
    uint64 rounds = 1;
    string winner = 2;
    repeated Round round = 3;
}

message Round {
    uint64 round = 1;
    uint64 blanks = 2;
    repeated CandidateStatus candidateStatus = 3;
}

message CandidateStatus {
    uint64 candidateRank = 1;
    string id = 2;
    double noOfVotes = 3;
    string status = 4;
}

message URL {
    string url = 1;
    uint64 election = 2;
    string voter = 3;
    bool voted = 4;
}

message Voter {
    string email = 1;
    string name = 2;
}
